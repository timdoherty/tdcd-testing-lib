import React from 'react';
<<<<<<< HEAD
import { shallow } from 'enzyme';

import Todo from '../Todo';

const props = {
  onChange() {},
  onRemove() {},
};

describe('<Todo/>', () => {
=======
import { render, fireEvent } from '@testing-library/react';
import '@testing-library/jest-dom/extend-expect';

import Todo from '../Todo';

describe('Todo', () => {
>>>>>>> 6591980... initial commit
  describe('given a task', () => {
    describe('when displayed', () => {
      it('shows the name of the task', () => {
        const todo = 'do it!';
<<<<<<< HEAD

        const wrapper = shallow(<Todo {...props} todo={todo} />);

        expect(wrapper.findWhere(node => node.text() === todo).exists()).toBe(
          true
        );
      });

      it('shows the status of the task', () => {
        const wrapper = shallow(<Todo {...props} isComplete={true} />);

        expect(
          wrapper
            .find('TodoStatus')
            .dive()
            .prop('checked')
        ).toBe(true);
      });
    });

    describe('when a user completes a task', () => {
      it('changes the status of the task', () => {
        const todo = 'doing it!';
        const todos = new Map([[todo, false]]);
        function toggle(todo) {
          todos.set(todo, !todos.get(todo));
        }
        const wrapper = shallow(
          <Todo {...props} todo={todo} onChange={toggle} />
        );

        wrapper
          .find('TodoStatus')
          .dive()
          .simulate('change');

        expect(todos.get(todo)).toBe(true);
      });
    });

    describe('when a user chooses to remove a task', () => {
      it('removes the task', () => {
        const todo = 'done it';
        const todos = new Map([[todo, true]]);
        function removeTodo(todo) {
          todos.delete(todo);
        }

        const wrapper = shallow(
          <Todo {...props} todo={todo} onRemove={removeTodo} />
        );

        wrapper.find('Delete').simulate('click');

        expect(todos.has(todo)).toBe(false);
=======
        const { container } = render(<Todo todo={todo} />);
        expect(container).toHaveTextContent(todo);
      });

      it('shows the status of the task', () => {
        const { getByRole } = render(<Todo isComplete={true} />);
        const checkbox = getByRole('checkbox');
        expect(checkbox).toBeChecked();
      });
    });

    describe('when a user toggles the task status', () => {
      it('responds with the name of the task', () => {
        const todo = 'todoit';
        const onCompletedToggled = jest.fn();
        const { getByRole } = render(
          <Todo todo={todo} onCompletedToggled={onCompletedToggled} />
        );
        const checkbox = getByRole('checkbox');
        fireEvent.click(checkbox);
        expect(onCompletedToggled).toHaveBeenCalledWith(todo);
      });
    });

    describe('when a user deletes a task', () => {
      it('responds with the name of the deleted task', () => {
        const todo = 'todoit';
        const onDeleted = jest.fn();
        const { getByRole } = render(
          <Todo todo={todo} onDeleted={onDeleted} />
        );
        const deleteButton = getByRole('button');
        fireEvent.click(deleteButton);
        expect(onDeleted).toHaveBeenCalledWith(todo);
>>>>>>> 6591980... initial commit
      });
    });
  });
});
